- hosts: all
#  connection: local # When running locally
  become: no
  gather_facts: no
  ignore_errors: true
  order: sorted

  collections:
    - ansible.builtin
    - community.general

  tasks:

    - name: check last patch
      command: bash -c 'dnf history |grep "update" | egrep "2024-12|2025" | head -1'
      register: cmdoutput

    - name: save date to a fact
      set_fact:
        last_patch_date: "{{ cmdoutput.stdout_lines }}"

    - name: print date
      debug:
        var: last_patch_date

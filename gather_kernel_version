---
- name: Gather installed kernel versions and generate report
  hosts: all
  gather_facts: yes
  tasks:
    - name: Gather installed kernel versions
      command: rpm -qa | grep kernel
      register: kernel_versions

    - name: Generate report
      copy:
        content: |
          Kernel Versions Report
          ======================
          Server: {{ inventory_hostname }}
          {% for kernel in kernel_versions.stdout_lines %}
          - {{ kernel }}
          {% endfor %}
        dest: /tmp/kernel_versions_report_{{ inventory_hostname }}.txt

    - name: Display report
      cat:
        path: /tmp/kernel_versions_report_{{ inventory_hostname }}.txt
